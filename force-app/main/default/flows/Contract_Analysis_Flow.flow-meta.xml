<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>60.0</apiVersion>
    <description>Automated contract analysis flow that triggers when a contract is uploaded</description>
    <label>Contract Analysis Flow</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordUpdates>
        <name>Update_Contract_Status_Processing</name>
        <label>Update Contract Status to Processing</label>
        <locationX>196</locationX>
        <locationY>0</locationY>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Processing</stringValue>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Processing_Contract__c</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract_Status_Processing_Contract__c</name>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Processing</stringValue>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Processing</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract_Status_Analyzed</name>
        <label>Update Contract Status to Analyzed</label>
        <locationX>196</locationX>
        <locationY>200</locationY>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Analyzed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Analyzed_Date__c</name>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Analyzed_Contract__c</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract_Status_Analyzed_Contract__c</name>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Analyzed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Analyzed_Date__c</name>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Analyzed</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract_Status_Failed</name>
        <label>Update Contract Status to Failed</label>
        <locationX>196</locationX>
        <locationY>400</locationY>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Failed</stringValue>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Failed_Contract__c</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contract_Status_Failed_Contract__c</name>
        <inputAssignments>
            <name>Status__c</name>
            <value>
                <stringValue>Failed</stringValue>
            </value>
        </inputAssignments>
        <inputReference>Update_Contract_Status_Failed</inputReference>
    </recordUpdates>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Update_Contract_Status_Processing</targetReference>
        </connector>
    </start>
    <triggers>
        <name>Contract_Analysis_Trigger</name>
        <label>Contract Analysis Trigger</label>
        <triggerType>RecordBeforeSave</triggerType>
        <triggerObject>Contract__c</triggerObject>
        <conditions>
            <field>Status__c</field>
            <operator>IsChanged</operator>
            <value>
                <stringValue>Uploaded</stringValue>
            </value>
        </conditions>
    </triggers>
</Flow>